librarry manipulated version. be careful !